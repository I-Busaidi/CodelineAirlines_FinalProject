@page "/Profile"
@layout Layout.MainLayout
@inject IPassengerService PassengerService
@inject NavigationManager NavManager

<div class="page-container">

    <!-- Users Table -->
    <MudDataGrid T="User" Items="@users" ReadOnly="@_readOnly"
                 EditMode="@(_isCellEditMode ? DataGridEditMode.Cell : DataGridEditMode.Form)"
                 Bordered="true" Dense="true"
                 EditTrigger="@(_editTriggerRowClick ? DataGridEditTrigger.OnRowClick : DataGridEditTrigger.Manual)">
        <Columns>
            <!-- Email Column -->
            <PropertyColumn Property="x => x.Email" Title="Email" />

            <!-- Name Column -->
            <PropertyColumn Property="x => x.Name" Title="Name" />

            <!-- Edit Button Column -->
            <TemplateColumn CellClass="d-flex justify-end">
                <CellTemplate>
                    <MudIconButton Size="@Size.Small" Icon="@Icons.Material.Outlined.Edit" OnClick="@context.Actions.StartEditingItemAsync" />
                </CellTemplate>
            </TemplateColumn>
        </Columns>
    </MudDataGrid>

    <MudText Typo="Typo.h4" Class="mb-4">Passenger List</MudText>

    <!-- Passenger List -->
    <MudExpansionPanels>
        @if (passengers != null && passengers.Any())
        {
            @foreach (var passenger in passengers)
            {
                <MudExpansionPanel Text="@($"{passenger.PassengerName} → {passenger.Nationality}")">
                    <MudPaper Class="pa-4">
                        <MudGrid>
                            <MudItem xs="8">
                                <MudText Typo="Typo.subtitle1"><b>Passenger Name:</b> @passenger.PassengerName</MudText>
                                <MudText Typo="Typo.subtitle1"><b>Passport:</b> @passenger.Passport</MudText>
                                <MudText Typo="Typo.subtitle1"><b>Gender:</b> @passenger.Gender</MudText>
                                <MudText Typo="Typo.subtitle1"><b>Birth Date:</b> @passenger.BirthDate.ToString("dd/MM/yyyy")</MudText>
                                <MudText Typo="Typo.subtitle1"><b>Nationality:</b> @passenger.Nationality</MudText>
                                <MudText Typo="Typo.subtitle1"><b>Loyalty Points:</b> @passenger.LoyaltyPoints</MudText>
                            </MudItem>
                            <MudItem xs="4" Class="text-right">
                                <MudButton Variant="Variant.Filled" DropShadow="false" Color="Color.Primary">
                                    BOOK NOW
                                </MudButton>
                            </MudItem>
                        </MudGrid>
                    </MudPaper>
                </MudExpansionPanel>
            }
        }
        else
        {
            <MudExpansionPanel Text="No passenger found">
                <MudText Color="Color.Secondary" Typo="Typo.body2">No passengers available at the moment.</MudText>
            </MudExpansionPanel>
        }
    </MudExpansionPanels>
</div>


@code {
    // Users List
    private IEnumerable<User> users = new List<User>
    {
        new User { Name = "Marcella Wallace", Email = "admin@demo.com" }
    };

    // Passenger List
    private List<PassengerOutputDTO> passengers { get; set; } = new();

    // Grid Settings
    private bool _readOnly = false;
    private bool _isCellEditMode = true;
    private bool _editTriggerRowClick = true;

    // Initialization
    protected override void OnInitialized()
    {
        GetPassengerProfile();
    }

    private void GetPassengerProfile()
    {
        // Fetch passenger profile data using the service
       // passengers = PassengerService.GetPassengerProfile(userId);
    }

    // User Model
    public class User
    {
        public string Name { get; set; }
        public string Email { get; set; }
    }
}


<style>
    .page-container {
        display: flex;
        justify-content: center; 
        align-items: center; 
        height: 100vh; 
        flex-direction: column; 
        text-align: center; 
        background-color:lightgray; 
    }

    .MudDataGrid {
        width: 200; 
        max-width: 800px; 
    }

</style>